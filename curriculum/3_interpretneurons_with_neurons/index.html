<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>1.3 Interpret Neurons with Neurons | SAIL Team Interpretability</title> <meta name="author" content="SAIL Team Interpretability"> <meta name="description" content="üìô Chapter 1. Neuron &lt;br&gt; &lt;em&gt; Can you find meaningful neurons with neurons?&lt;/em&gt;"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://team-interpret.github.io/curriculum/3_interpretneurons_with_neurons/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "1.3 Interpret Neurons with Neurons",
      "description": "üìô Chapter 1. Neuron <br> <em> Can you find meaningful neurons with neurons?</em>",
      "published": "August 14, 2023",
      "authors": [
        {
          "author": "Bumjin Park",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        },
        {
          "author": "Youngju Joung",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        },
        {
          "author": "Enver Menadjiev",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a href="http://sailab.kaist.ac.kr/" rel="external nofollow noopener" target="_blank"> <img src="/assets/img/sail_logo_white.png" width="80px" style="margin-right:20px; margin-left:-100px; padding-bottom: 0px; border: solid #737ea3 1px; border-radius: 10px;"> </a> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">SAIL¬†</span>Team¬†Interpretability</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/curriculum/">Curriculum</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>1.3 Interpret Neurons with Neurons</h1> <p>üìô Chapter 1. Neuron <br> <em> Can you find meaningful neurons with neurons?</em></p> </d-title> <d-byline></d-byline> <d-article> <h2 id="interpret-neurons-with-neurons">Interpret Neurons with Neurons</h2> <p>Inside of a deep neural network, numerous neurons exist, and each of them activated by some specific patterns. We can easily assume the existence of such neurons in the complex inside, but finding such neurons requires expensive efforts such as Network Dissection and CLIP Dissection. Unlike visualizing the detected region of a neuron, a much easier way is learning a classifier to verify the semantic meaning of neurons so that the weight of the classifier reveals the relationship between the activation of the neuron and a specific pattern. To further understand the easiness of such a method, assume the situation where we want to find a neuron detecting ‚ÄúThe Stripe Pattern in Zebra‚Äù.</p> <ul> <li> <strong>Difficulty 1</strong>: there are numerous neurons in a network which are fired with a zebra image. <br> (Multiple neurons are activated by a single image)</li> <li> <strong>Difficulty 2</strong>: we don‚Äôt know how much to be activated for the pattern. <br> (The proper threshold for activation)</li> <li> <strong>Difficulty 3</strong>: The proportion of activation might not be 100%. In what threshold, can we Difficulty that the neuron has the semantic pattern? <br> (How much # Activated Samples / # Total Samples? )</li> </ul> <p>These difficulties has the same goal:</p> <blockquote> <p>How can we determine the features of a neuron with the activation patterns?</p> </blockquote> <p>To solve this problem with another deep neural network, we must consider two types of neurons, a neuron capturing a semantic pattern and a neuron interpreting the activation of the neuron. Two neurons have the following domain and co-domain.</p> <ul> <li>Pattern neuron : Input ‚Üí Activation Score ($x \mapsto h$)</li> <li>Interpretation neuron : Activation Score ‚Üí Concept ($h \mapsto C$)</li> </ul> <h2 id="pattern-neuron">Pattern Neuron</h2> <figure style="text-align:left; display:block;width:100;"> <img src="/assets/img/neurons_interpret_neurons/feature_neuron.png" style="width:100%"> <figcaption> <p>Figure. Several inputs are mapped to the neuron‚Äôs output. They leave activation signals. With the assumption that the neuron has semantic meaning, large value of <code class="language-plaintext highlighter-rouge">F</code> will be considered to have more degree of a feature.</p> </figcaption> </figure> <p>A pattern neuron has positively correlated activation patterns with respect to a specific semantic image, such as strip patterns. As the intensity of the activation is stronger, the activation of the neuron is higher. On the other hand, if the pattern does not exist in the input, the neuron must not propagate signals. In addition, this assumption could be stochastic as the activation patterns could have noise.</p> <blockquote> <p><strong>Formulation for a pattern neuron</strong></p> <ul> <li>$x$ : an input</li> <li>$h$ : activation of the neuron</li> <li>$f_n$ : a function maps input $x$ to activation $h$.</li> <li>$c_n$ : the concept related to neuron $n$</li> </ul> </blockquote> <h2 id="interpretation-neurons">Interpretation Neurons</h2> <p>The interpretation neuron takes activation score as an input and outputs the decision of concept with a separate neuron. Note that the interpretation neuron is not internal neurons of the original network. They are separate neurons which will be trained for the interpretation of activation values.</p> <figure style="text-align:left; display:block;width:100;"> <img src="/assets/img/neurons_interpret_neurons/interpretation_neuron.png" style="width:100%"> <figcaption> Figure. Several inputs are mapped to the neuron and leave activations. The interpretation neuron will be trained to classify the concept patterns with the activation signals. </figcaption> </figure> <p>The interpretation neuron is a function $g$ which can have the most simplest form as follows:</p> \[g_n = \sigma (wh+b)\] <p>Here $\sigma$ is a sigmoid function to be used for the decision of a concept. With such formulation we can interpret the decision as follows: If there is positive correlation between $h$ and concept $c$, the weight will be positive If there is no correlation between the activation and concept, the weight will be close to zero.</p> <blockquote> <p><strong>Formulation for an interpretation neuron</strong></p> <ul> <li>$h$ : an input</li> <li>$c$ : the concept to be verified for an input</li> <li>$g$ : a mapping from $h$ to $c$.</li> <li>$w,b$ : weight and bias for the classifier $g$.</li> </ul> </blockquote> <p>This classifier can help us to mitigate the difficulties 2 and 3 (The proper threshold for activation, and How much # Activated Samples / # Total Samples?). However, difficulty 1 (numerous neurons) is not solved with learning a classifier with input size 1. To solve it, we further formulate a classifier with high-dimensional input space.</p> <h2 id="interpretation-neuron-for-multiple-neurons">Interpretation Neuron for Multiple Neurons</h2> <p>There is not much difference between 1D input space and high-dimensional input space. We just widen the input space. However, this simple trick will ease the interpretation of a neuron and the combination of several neurons.</p> <blockquote> <p><strong>Formulation for an interpretation neuron</strong></p> <ul> <li>$\mathbb{h}$ : an input</li> <li>$c$ : the concept to be verified for an input</li> <li>$g$ : a mapping from $h$ to $c$.</li> <li>$W, \mathbf{b}$ : weight and bias for the classifier $g$.</li> </ul> </blockquote> <p>Most previous work uses the representation of a layer for an input. The verification of a concept is done by learning a classifier whose input is a layer-representation and the output is a boolean for a specific concept. Note that when we can actually learn this, we may say there is a concept in activations. Even though this formulation has probed neurons with layer-representation, we don‚Äôt have to limit the function. We can learn a classifier whose input is the whole activation of a network. In this case, we can verify the neurons at once!</p> <h2 id="probing">Probing</h2> <p>The verification of neurons is called <em>probing</em>. We probe the semantic information of neurons. The overall algorithm is as follows:</p> <p>Prepare samples Positive : Inputs which have concepts in its input space. (Label 1) Negative : random or opposite conceptual images. (Label 0)<br> Gather all activations of a network with samples in Step 1. Replace inputs in Step1 with the activations in Step2 Train a classifier whose input is the activation score and the concept labels. Check the accuracy to see the positive correlation between the activations and the concept. Check the weight to verify the important neurons.</p> <h3 id="linear-probing">Linear Probing</h3> <p>If you use a linear classifier in probing, it is called linear probing. The advantage of linear probing is the ease of weight interpretation. As we want to verify the semantic information of neurons, we must know the relation between each neuron and the concept. The weight can provide this information</p> <h3 id="non-linear-probing">Non-linear Probing</h3> <p>If you use a non-linear classifier in probing, it is called linear probing. The advantage of non-linear probing is that the concept could be complex and the linear relationship between neurons and concepts may not be enough, but the non-linear relationship may be.</p> <h2 id="interpret-chess-concepts">Interpret Chess Concepts</h2> <p>Chess has many meaningful concepts in board states such as ‚ÄúCheckmate‚Äù, ‚Äú ‚Äú. Thomas et al. <d-cite key="mcgrath2022acquisition"></d-cite> investigate the concepts in chess with AlphaZero model. Note that the network obtains only a board state and outputs preferred action and there is no explicit encode of concepts. Therefore, verification of neurons is about the existence of meaningful chess concepts in the internal representations.</p> <figure style="text-align:left; display:block;width:100;"> <img src="/assets/img/neurons_interpret_neurons/chess_concepts.png" style="width:100%"> <figcaption> <p>Figure. <em>What-when-where</em> plot to visualize the emergence of concepts in the network. Note that the z-axis is the accuracy of the probing network.</p> </figcaption> </figure> <figure style="text-align:left; display:block;width:100;"> <img src="/assets/img/neurons_interpret_neurons/regression.png" style="width:100%"> <figcaption> <p>Figure. Regression probing.</p> </figcaption> </figure> <h2 id="testing-with-concept-activation-vector">Testing with Concept Activation Vector</h2> <p>What natural question followed by the concept is the usefulness. That is, how important the concept stripe is for the class zebra. Similarly, how much is the concept red important for the class firefighter? To answer this question, we need a qualitative measure. Testing with Concept Activation Vector (TCAV) <d-cite key="kim2018interpretability"></d-cite> is a measure which counts the number of samples that increased the class logic as the activation intervened with concept direction.</p> <p>Assume that we obtained the directional vector $v$ for the concept $C$. If the direction increases the concept, we get intervene the activation with the direction by adding, $f_l(x) + \epsilon v_C^l$. The answered question in TCAV paper is as follows:</p> <blockquote> <p>If the conceptual information added to the representation, will it increase the classification logit?</p> </blockquote> <p>For example, if we increase the black and white stripe patterns, the likelihood of zebra class will be increased. TCAV is a quantitative measure to this question and answers it with the ratio of samples which increased the logic.</p> <h3 id="conceptual-sensitivity-of-class-k-to-concept-c">Conceptual Sensitivity of class k to concept C</h3> \[\begin{aligned} S_{C,k,l}(\mathbf{x}) &amp;= \lim_{\epsilon \rightarrow 0} \frac{h_{l,k}(f_l (\mathbf{x}) + \epsilon v_C^l) - h_{l,k}(f_l(\mathbf{x}))}{\epsilon} \\ &amp;= \nabla h_{l,k}(f_l(\mathbf{x})) \cdot v_C^{l} \end{aligned}\] <h3 id="tcav">TCAV</h3> <p>Now the authors defined TCAV as follows.</p> \[\mathrm{TCAV}_{Q_{C, k,l}} = \frac{\vert \{ x\in X_k : S_{C,k,l} (x) &gt; 0 \}\vert }{\vert X_k \vert}\] </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/all.bib"></d-bibliography><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"team-interpret/team-interpret","data-repo-id":"R_kgDOKCB5Vw","data-category":"Q&A","data-category-id":"DIC_kwDOKCB5V84CYQ_P","data-mapping":"title","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> ¬© Copyright 2023 SAIL Team Interpretability. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>